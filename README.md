# PHP文件加密工具 🔐

一个现代化的PHP文件加密保护工具，提供高强度的代码保护和混淆功能。

## 🌟 主要特性

### 🔒 高级加密保护
- **AES-256-GCM加密**：银行级加密标准，确保代码绝对安全
- **PBKDF2密钥派生**：增强密钥安全性，防止暴力破解
- **完整性校验**：HMAC签名确保文件未被篡改
- **自解密设计**：加密文件包含解密器，无需服务器额外扩展

### 🎨 现代化界面
- **Material Design风格**：美观现代的用户界面
- **拖拽操作**：支持文件和文件夹拖拽
- **实时进度**：详细的加密/解密进度显示
- **批量处理**：支持大批量文件同时处理

### 🛡️ 代码混淆
- **变量名混淆**：智能替换变量名，保留关键字
- **字符串混淆**：多种字符串编码方式
- **函数名混淆**：可选的函数名保护
- **反调试保护**：检测调试环境，防止分析

### ⚡ 高性能
- **分块加密**：大文件分块处理，内存友好
- **多线程处理**：支持并发加密多个文件
- **增量处理**：只处理变化的代码块
- **压缩优化**：自动压缩减少文件大小

## 📋 系统要求

- **Python 3.8+**
- **PyQt6**
- **Cryptography**
- **Windows/Linux/macOS**

## 🚀 快速开始

### 安装依赖

```bash
# 克隆或下载项目
cd php-encryptor

# 安装依赖包
pip install -r requirements.txt
```

### 运行程序

```bash
# 启动图形界面
python main.py
```

## 📖 使用指南

### 加密文件

1. **添加文件**
   - 点击"📁 添加PHP文件"选择单个或多个PHP文件
   - 点击"📂 添加文件夹"批量选择目录中的PHP文件
   - 直接拖拽PHP文件到程序窗口

2. **配置选项**
   - ✅ 混淆变量名：推荐开启，大幅增加逆向难度
   - ✅ 混淆字符串：推荐开启，保护字符串常量
   - ✅ 混淆函数名：可选，可能影响调试
   - 🔢 加密强度：1-5级，越高越安全但性能略降

3. **开始加密**
   - 点击"🚀 开始加密"
   - 选择输出目录
   - 等待处理完成
   - 自动生成密钥文件（保存好！）

### 解密文件

1. **添加文件**
   - 点击"📁 添加加密文件"选择要解密的PHP文件

2. **选择密钥**
   - 点击"🔑 选择密钥文件"
   - 选择之前生成的密钥JSON文件

3. **开始解密**
   - 点击"🚀 开始解密"
   - 选择输出目录
   - 等待处理完成

## 🔧 配置选项

编辑 `config.ini` 文件可自定义配置：

```ini
[DEFAULT]
# 加密配置
encryption_algorithm = aes-256-gcm
key_derivation = pbkdf2
pbkdf2_iterations = 100000

# 混淆配置
obfuscate_variables = true
obfuscate_strings = true
obfuscate_functions = false
variable_prefix = __OBF_

# 安全配置
integrity_check = true
anti_debug = true
```

## 🛡️ 安全特性

### 加密保护
- **强加密算法**：AES-256-GCM提供机密性和完整性
- **密钥分离**：主密钥和文件密钥分离，提高安全性
- **随机化**：每次加密使用不同的随机参数

### 混淆技术
- **智能重命名**：避免关键字和超全局变量
- **字符串编码**：chr()、base64、十六进制混合使用
- **控制流混淆**：插入无用的反调试代码

### 运行时保护
- **环境验证**：检测PHP版本和扩展
- **完整性检查**：HMAC签名验证
- **内存清理**：执行后自动清理敏感数据

## 📁 文件结构

```
php-encryptor/
├── main.py                 # 主程序入口
├── requirements.txt        # 依赖包列表
├── config.ini             # 配置文件
├── core/                   # 核心模块
│   ├── key_manager.py     # 密钥管理
│   ├── encryptor.py       # 加密引擎
│   └── decryptor.py       # 解密引擎
├── utils/                  # 工具模块
│   ├── php_parser.py      # PHP代码解析
│   ├── obfuscator.py      # 代码混淆
│   └── file_handler.py    # 文件处理
├── gui/                    # 界面模块
│   ├── main_window.py     # 主窗口
│   ├── encrypt_dialog.py  # 加密对话框
│   └── decrypt_dialog.py  # 解密对话框
└── README.md              # 说明文档
```

## 🔒 安全建议

### 密钥管理
- **备份密钥**：妥善保存密钥文件，建议多处备份
- **定期更换**：定期更换加密密钥提高安全性
- **权限控制**：限制密钥文件的访问权限

### 部署建议
- **测试环境**：先在测试环境验证加密后的代码
- **版本控制**：不要将密钥文件提交到版本控制系统
- **监控日志**：关注服务器的错误日志

## 🐛 常见问题

### Q: 加密后的文件无法运行？
A: 请检查：
- PHP版本是否 >= 7.4
- 是否开启了OpenSSL扩展
- 密钥文件是否正确

### Q: 混淆后出现语法错误？
A: 可能原因：
- 源代码本身有语法错误
- 特殊的PHP语法不被支持
- 建议关闭函数名混淆选项

### Q: 加密速度很慢？
A: 优化建议：
- 关闭不必要的混淆选项
- 降低加密强度级别
- 避免同时处理过多大文件

### Q: 忘记密钥文件怎么办？
A: 很遗憾，没有密钥文件无法解密。建议：
- 使用云存储备份密钥
- 设置密钥文件的定期提醒
- 使用密码管理器保存密钥信息

## 📝 更新日志

### v1.0.0 
- ✨ 初始版本发布
- 🔒 AES-256-GCM加密支持
- 🎨 现代化PyQt6界面
- 🛡️ 代码混淆功能
- 📁 批量文件处理
- 🔑 自动密钥生成

## 🤝 技术支持

如遇到问题，请：
1. 检查本文档的常见问题
2. 确认系统环境和依赖
3. 查看程序运行日志

---

> ⚠️ **重要提醒**：请妥善保管密钥文件，丢失密钥将无法解密文件！
